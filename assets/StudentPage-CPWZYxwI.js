import{c as te,j as e,M as y,u as O,a as ne,k as v,n as w,B as x,T as c,P as se,I as ae,o as le,A as ie,p as de,q as re}from"./index-DTehqcyh.js";import{r as o}from"./vendor-nY0NvAmL.js";import{G as r,A as ce,C as oe,T as ue,a as xe,b as he,c as R,d as h,e as me,M as je,E as ge,D as pe,f as fe,g as be,h as Se,i as ve,S as ye}from"./MoreVert-BNaklvyy.js";import{T as m,a as V,I as H,S as U,E as Ce,A as Ae}from"./Email-BOEMhuZM.js";import{B as p}from"./Button-BjlhxKJZ.js";import"./react-DJG_os-6.js";const Ee=te(e.jsx("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z"})),We=({formData:i,addFormChange:d,grades:j})=>e.jsxs(r,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(r,{xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"Name",name:"name",type:"text",value:i.name||"",onChange:d,required:!0})}),e.jsx(r,{xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"Email",name:"email",type:"email",value:i.email||"",onChange:d,required:!0})}),e.jsx(r,{xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"Contact",name:"contact",type:"tel",value:i.contact||"",onChange:d,required:!0})}),e.jsx(r,{xs:12,md:6,children:e.jsxs(V,{fullWidth:!0,required:!0,children:[e.jsx(H,{children:"Grade"}),e.jsx(U,{name:"grade",value:i.grade||"",label:"Grade",onChange:d,children:j.map(u=>e.jsx(y,{value:u,children:u},u))})]})}),e.jsx(r,{xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"Age",name:"age",type:"number",value:i.age||"",onChange:d,required:!0})})]}),Te=({formData:i,handleFormChange:d,grades:j})=>e.jsxs(r,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"Student Name",name:"name",value:i.name,onChange:d,variant:"outlined",required:!0})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"Email",name:"email",type:"email",value:i.email,onChange:d,variant:"outlined",required:!0})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"Contact Number",name:"contact",value:i.contact,onChange:d,variant:"outlined",required:!0})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(m,{fullWidth:!0,label:"Age",name:"age",type:"number",value:i.age,onChange:d,variant:"outlined",required:!0})}),e.jsx(r,{item:!0,xs:12,children:e.jsxs(V,{fullWidth:!0,variant:"outlined",required:!0,children:[e.jsx(H,{children:"Grade"}),e.jsx(U,{name:"grade",value:i.grade,onChange:d,label:"Grade",children:j.map(u=>e.jsx(y,{value:u,children:u},u))})]})})]});function Me(){const{students:i,isLoading:d,isSuccess:j,addSuccess:u,updateSuccess:k,deleteSuccess:q}=O(t=>t.student),{user:Y}=O(t=>t.auth),f=Y?.permissions||[],J=f.includes("create"),K=f.includes("view"),C=f.includes("edit"),A=f.includes("delete"),a=ne(),[G,I]=o.useState(null),[E,b]=o.useState(null),[Q,M]=o.useState(!1),[l,B]=o.useState(""),[n,S]=o.useState({name:"",email:"",contact:"",grade:"",age:""}),[W,z]=o.useState({open:!1,type:"success",message:""}),T=(t,s)=>{z({open:!0,type:t,message:s})};o.useEffect(()=>()=>{j&&a(v())},[a,j]),o.useEffect(()=>{a(w())},[a]),o.useEffect(()=>{u&&l==="add"&&(g(),T("success","Student added successfully!"),a(v()))},[u,l,a]),o.useEffect(()=>{k&&l==="edit"&&(g(),T("success","Student updated successfully!"),a(v()),a(w()))},[k,l,a]),o.useEffect(()=>{q&&l==="delete"&&(g(),T("success","Student deleted successfully!"),a(v()),a(w()))},[q,l,a]);const _=(t,s)=>{s!=="clickaway"&&z(ee=>({...ee,open:!1}))},X=(t,s)=>{I(t.currentTarget),b(s)},N=()=>{I(null),b(null)},D=(t,s=null)=>{B(t),b(s),M(!0),t==="add"?S({name:"",email:"",contact:"",grade:"",age:""}):s&&(t==="edit"||t==="view"||t==="delete")&&S({_id:s._id||"",name:s.name||"",email:s.email||"",contact:s.contact||"",grade:s.grade||"",age:s.age||""}),N()},g=()=>{M(!1),b(null),B(""),S({name:"",email:"",contact:"",grade:"",age:""})},P=t=>{S({...n,[t.target.name]:t.target.value})},Z=()=>{const t={name:n.name,email:n.email,contact:n.contact,grade:n.grade,age:n.age};a(ie(t))},$=()=>{const t={_id:n?._id,name:n.name,email:n.email,contact:n.contact,grade:n.grade,age:n.age};a(de(t))},F=()=>{a(re(n._id))},L=["9th Grade","10th Grade","11th Grade","12th Grade"];return K?e.jsxs(x,{sx:{p:3},children:[e.jsxs(x,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(x,{children:[e.jsx(c,{variant:"h4",fontWeight:"bold",gutterBottom:!0,children:"Students Management"}),e.jsx(c,{variant:"body1",color:"text.secondary",children:"Manage and view all students in your school"})]}),e.jsx(p,{variant:"contained",startIcon:e.jsx(ce,{}),disabled:!J,onClick:()=>D("add",E),sx:{borderRadius:2,textTransform:"none",px:3,py:1.5},children:"Add Student"})]}),d?e.jsx(x,{sx:{textAlign:"center",mt:5},children:e.jsx(c,{variant:"h6",color:"text.secondary",children:"Loading students..."})}):i.length===0?e.jsx(x,{sx:{textAlign:"center",mt:5},children:e.jsx(c,{variant:"h6",color:"text.secondary",children:"No students found."})}):e.jsx(oe,{children:e.jsx(ue,{component:se,children:e.jsxs(xe,{children:[e.jsx(he,{children:e.jsxs(R,{sx:{bgcolor:"#f5f5f5"},children:[e.jsx(h,{sx:{fontWeight:"bold"},children:"Student"}),e.jsx(h,{sx:{fontWeight:"bold"},children:"Contact"}),e.jsx(h,{sx:{fontWeight:"bold"},children:"Age"}),e.jsx(h,{sx:{fontWeight:"bold"},children:"Grade"}),e.jsx(h,{sx:{fontWeight:"bold"},children:"Actions"})]})}),e.jsx(me,{children:i.map(t=>e.jsxs(R,{hover:!0,children:[e.jsx(h,{children:e.jsx(x,{sx:{display:"flex",alignItems:"center"},children:e.jsx(c,{variant:"body2",fontWeight:"medium",children:t?.name})})}),e.jsx(h,{children:e.jsxs(x,{children:[e.jsxs(x,{sx:{display:"flex",alignItems:"center",mb:.5},children:[e.jsx(Ce,{sx:{fontSize:16,mr:1,color:"text.secondary"}}),e.jsx(c,{variant:"body2",children:t?.email})]}),e.jsxs(x,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Ee,{sx:{fontSize:16,mr:1,color:"text.secondary"}}),e.jsx(c,{variant:"body2",children:t?.contact})]})]})}),e.jsx(h,{children:e.jsx(c,{variant:"body2",children:t?.age})}),e.jsx(h,{children:e.jsx(c,{variant:"body2",children:t?.grade})}),e.jsx(h,{children:e.jsx(ae,{onClick:s=>X(s,t),size:"small",children:e.jsx(je,{})})})]},t?._id))})]})})}),e.jsxs(le,{anchorEl:G,open:!!G,onClose:N,children:[e.jsxs(y,{onClick:()=>D("edit",E),disabled:!C,sx:{color:C?"inherit":"text.disabled",pointerEvents:C?"auto":"none"},children:[e.jsx(ge,{sx:{mr:1},fontSize:"small"}),"Edit Details"]}),e.jsxs(y,{onClick:()=>D("delete",E),disabled:!A,sx:{color:A?"inherit":"text.disabled",pointerEvents:A?"auto":"none"},children:[e.jsx(pe,{sx:{mr:1},fontSize:"small"}),"Delete"]})]}),e.jsxs(fe,{open:Q,onClose:g,maxWidth:"md",fullWidth:!0,children:[e.jsxs(be,{children:[l==="add"&&"Add New Student",l==="edit"&&"Edit Student Details",l==="delete"&&"Delete Student"]}),e.jsxs(Se,{children:[l==="add"&&e.jsx(We,{formData:n,addFormChange:P,grades:L}),l==="edit"&&e.jsx(Te,{formData:n,handleFormChange:P,grades:L}),l==="delete"&&e.jsx(c,{sx:{pt:2},children:"Are you sure you want to delete? This action cannot be undone."})]}),e.jsxs(ve,{sx:{p:2},children:[e.jsx(p,{onClick:g,children:"Cancel"}),l==="add"&&e.jsx(p,{variant:"contained",onClick:Z,disabled:!n.name||!n.email||!n.grade,children:"Add Student"}),l==="edit"&&e.jsx(p,{variant:"contained",color:"primary",onClick:$,disabled:!n.name||!n.email||!n.grade,children:"Update Student"}),l==="delete"&&e.jsx(p,{variant:"contained",color:"error",onClick:F,children:"Delete"})]})]}),e.jsx(ye,{open:W.open,autoHideDuration:4e3,onClose:_,anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(Ae,{onClose:_,severity:W.type,variant:"filled",sx:{width:"100%"},children:W.message})})]}):e.jsx(x,{sx:{p:5,textAlign:"center"},children:e.jsx(c,{variant:"h5",color:"error",children:"You do not have permission to view this page."})})}export{Me as default};
